/* Indicators.c generated by valac 0.32.1, the Vala compiler
 * generated from Indicators.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <gdk/gdk.h>
#include <pango/pango.h>
#include <math.h>
#include <float.h>
#include <cairo.h>


#define SLINGSHOT_FRONTEND_TYPE_INDICATORS (slingshot_frontend_indicators_get_type ())
#define SLINGSHOT_FRONTEND_INDICATORS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SLINGSHOT_FRONTEND_TYPE_INDICATORS, SlingshotFrontendIndicators))
#define SLINGSHOT_FRONTEND_INDICATORS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SLINGSHOT_FRONTEND_TYPE_INDICATORS, SlingshotFrontendIndicatorsClass))
#define SLINGSHOT_FRONTEND_IS_INDICATORS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SLINGSHOT_FRONTEND_TYPE_INDICATORS))
#define SLINGSHOT_FRONTEND_IS_INDICATORS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SLINGSHOT_FRONTEND_TYPE_INDICATORS))
#define SLINGSHOT_FRONTEND_INDICATORS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SLINGSHOT_FRONTEND_TYPE_INDICATORS, SlingshotFrontendIndicatorsClass))

typedef struct _SlingshotFrontendIndicators SlingshotFrontendIndicators;
typedef struct _SlingshotFrontendIndicatorsClass SlingshotFrontendIndicatorsClass;
typedef struct _SlingshotFrontendIndicatorsPrivate SlingshotFrontendIndicatorsPrivate;
#define __g_list_free__g_object_unref0_0(var) ((var == NULL) ? NULL : (var = (_g_list_free__g_object_unref0_ (var), NULL)))
typedef struct _Block2Data Block2Data;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define __vala_PangoFontDescription_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoFontDescription_free (var), NULL)))
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))
#define _cairo_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_destroy (var), NULL)))

struct _SlingshotFrontendIndicators {
	GtkHBox parent_instance;
	SlingshotFrontendIndicatorsPrivate * priv;
	GList* children;
	gint active;
};

struct _SlingshotFrontendIndicatorsClass {
	GtkHBoxClass parent_class;
};

struct _SlingshotFrontendIndicatorsPrivate {
	gint animation_duration;
	gint animation_frames;
	gint current_frame;
	guint animation_loop_id;
	gboolean animation_active;
	gint old_active;
};

struct _Block2Data {
	int _ref_count_;
	SlingshotFrontendIndicators* self;
	GtkEventBox* indicator;
};


static gpointer slingshot_frontend_indicators_parent_class = NULL;

GType slingshot_frontend_indicators_get_type (void) G_GNUC_CONST;
#define SLINGSHOT_FRONTEND_INDICATORS_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), SLINGSHOT_FRONTEND_TYPE_INDICATORS, SlingshotFrontendIndicatorsPrivate))
enum  {
	SLINGSHOT_FRONTEND_INDICATORS_DUMMY_PROPERTY
};
static void _g_object_unref0_ (gpointer var);
static void _g_list_free__g_object_unref0_ (GList* self);
#define SLINGSHOT_FRONTEND_INDICATORS_FPS 60
SlingshotFrontendIndicators* slingshot_frontend_indicators_new (void);
SlingshotFrontendIndicators* slingshot_frontend_indicators_construct (GType object_type);
void slingshot_frontend_indicators_append (SlingshotFrontendIndicators* self, const gchar* thelabel);
static Block2Data* block2_data_ref (Block2Data* _data2_);
static void block2_data_unref (void * _userdata_);
GtkAlignment* slingshot_frontend_utilities_wrap_alignment (GtkWidget* widget, gint top, gint right, gint bottom, gint left);
gboolean slingshot_frontend_indicators_draw_background (SlingshotFrontendIndicators* self, GtkWidget* widget, GdkEventExpose* event);
static gboolean _slingshot_frontend_indicators_draw_background_gtk_widget_expose_event (GtkWidget* _sender, GdkEventExpose* event, gpointer self);
static gboolean __lambda12_ (Block2Data* _data2_);
void slingshot_frontend_indicators_set_active (SlingshotFrontendIndicators* self, gint index);
static gboolean ___lambda12__gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static void _vala_PangoFontDescription_free (PangoFontDescription* self);
void slingshot_frontend_indicators_set_active_no_signal (SlingshotFrontendIndicators* self, gint index);
void slingshot_frontend_indicators_change_focus (SlingshotFrontendIndicators* self);
static void slingshot_frontend_indicators_end_animation (SlingshotFrontendIndicators* self);
static gboolean __lambda13_ (SlingshotFrontendIndicators* self);
static gboolean ___lambda13__gsource_func (gpointer self);
static void slingshot_frontend_indicators_finalize (GObject* obj);


static void _g_object_unref0_ (gpointer var) {
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
}


static void _g_list_free__g_object_unref0_ (GList* self) {
	g_list_foreach (self, (GFunc) _g_object_unref0_, NULL);
	g_list_free (self);
}


SlingshotFrontendIndicators* slingshot_frontend_indicators_construct (GType object_type) {
	SlingshotFrontendIndicators * self = NULL;
	self = (SlingshotFrontendIndicators*) g_object_new (object_type, NULL);
	gtk_box_set_homogeneous ((GtkBox*) self, FALSE);
	gtk_box_set_spacing ((GtkBox*) self, 0);
	return self;
}


SlingshotFrontendIndicators* slingshot_frontend_indicators_new (void) {
	return slingshot_frontend_indicators_construct (SLINGSHOT_FRONTEND_TYPE_INDICATORS);
}


static Block2Data* block2_data_ref (Block2Data* _data2_) {
	g_atomic_int_inc (&_data2_->_ref_count_);
	return _data2_;
}


static void block2_data_unref (void * _userdata_) {
	Block2Data* _data2_;
	_data2_ = (Block2Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data2_->_ref_count_)) {
		SlingshotFrontendIndicators* self;
		self = _data2_->self;
		_g_object_unref0 (_data2_->indicator);
		_g_object_unref0 (self);
		g_slice_free (Block2Data, _data2_);
	}
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static gboolean _slingshot_frontend_indicators_draw_background_gtk_widget_expose_event (GtkWidget* _sender, GdkEventExpose* event, gpointer self) {
	gboolean result;
	result = slingshot_frontend_indicators_draw_background ((SlingshotFrontendIndicators*) self, _sender, event);
	return result;
}


static gboolean __lambda12_ (Block2Data* _data2_) {
	SlingshotFrontendIndicators* self;
	gboolean result = FALSE;
	GList* _tmp0_ = NULL;
	gint _tmp1_ = 0;
	self = _data2_->self;
	_tmp0_ = self->children;
	_tmp1_ = g_list_index (_tmp0_, (GtkWidget*) _data2_->indicator);
	slingshot_frontend_indicators_set_active (self, _tmp1_);
	result = TRUE;
	return result;
}


static gboolean ___lambda12__gtk_widget_button_release_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda12_ (self);
	return result;
}


static void _vala_PangoFontDescription_free (PangoFontDescription* self) {
	g_boxed_free (pango_font_description_get_type (), self);
}


void slingshot_frontend_indicators_append (SlingshotFrontendIndicators* self, const gchar* thelabel) {
	Block2Data* _data2_;
	GtkEventBox* _tmp0_ = NULL;
	GtkLabel* label = NULL;
	const gchar* _tmp1_ = NULL;
	GtkLabel* _tmp2_ = NULL;
	GdkColor white = {0};
	GdkColor _tmp3_ = {0};
	GdkColor _tmp4_ = {0};
	PangoFontDescription* font = NULL;
	PangoFontDescription* _tmp5_ = NULL;
	GtkAlignment* _tmp6_ = NULL;
	GtkAlignment* _tmp7_ = NULL;
	GtkWidget* _tmp8_ = NULL;
	g_return_if_fail (self != NULL);
	g_return_if_fail (thelabel != NULL);
	_data2_ = g_slice_new0 (Block2Data);
	_data2_->_ref_count_ = 1;
	_data2_->self = g_object_ref (self);
	_tmp0_ = (GtkEventBox*) gtk_event_box_new ();
	g_object_ref_sink (_tmp0_);
	_data2_->indicator = _tmp0_;
	gtk_event_box_set_visible_window (_data2_->indicator, FALSE);
	_tmp1_ = thelabel;
	_tmp2_ = (GtkLabel*) gtk_label_new (_tmp1_);
	g_object_ref_sink (_tmp2_);
	label = _tmp2_;
	gdk_color_parse ("#FFFFFF", &_tmp3_);
	white = _tmp3_;
	_tmp4_ = white;
	gtk_widget_modify_fg ((GtkWidget*) label, GTK_STATE_NORMAL, &_tmp4_);
	_tmp5_ = pango_font_description_new ();
	font = _tmp5_;
	pango_font_description_set_size (font, 9500);
	pango_font_description_set_weight (font, PANGO_WEIGHT_HEAVY);
	gtk_widget_modify_font ((GtkWidget*) label, font);
	_tmp6_ = slingshot_frontend_utilities_wrap_alignment ((GtkWidget*) label, 5, 15, 5, 15);
	_tmp7_ = _tmp6_;
	gtk_container_add ((GtkContainer*) _data2_->indicator, (GtkWidget*) _tmp7_);
	_g_object_unref0 (_tmp7_);
	_tmp8_ = _g_object_ref0 ((GtkWidget*) _data2_->indicator);
	self->children = g_list_append (self->children, _tmp8_);
	g_signal_connect_object ((GtkWidget*) self, "expose-event", (GCallback) _slingshot_frontend_indicators_draw_background_gtk_widget_expose_event, self, 0);
	g_signal_connect_data ((GtkWidget*) _data2_->indicator, "button-release-event", (GCallback) ___lambda12__gtk_widget_button_release_event, block2_data_ref (_data2_), (GClosureNotify) block2_data_unref, 0);
	gtk_box_pack_start ((GtkBox*) self, (GtkWidget*) _data2_->indicator, FALSE, FALSE, (guint) 0);
	__vala_PangoFontDescription_free0 (font);
	_g_object_unref0 (label);
	block2_data_unref (_data2_);
	_data2_ = NULL;
}


void slingshot_frontend_indicators_set_active_no_signal (SlingshotFrontendIndicators* self, gint index) {
	gint _tmp0_ = 0;
	GList* _tmp1_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = index;
	_tmp1_ = self->children;
	if (_tmp0_ <= (((gint) g_list_length) - 1)) {
		gint _tmp2_ = 0;
		gint _tmp3_ = 0;
		_tmp2_ = self->active;
		self->priv->old_active = _tmp2_;
		_tmp3_ = index;
		self->active = _tmp3_;
		slingshot_frontend_indicators_change_focus (self);
	}
}


void slingshot_frontend_indicators_set_active (SlingshotFrontendIndicators* self, gint index) {
	gint _tmp0_ = 0;
	g_return_if_fail (self != NULL);
	_tmp0_ = index;
	slingshot_frontend_indicators_set_active_no_signal (self, _tmp0_);
	g_signal_emit_by_name (self, "child-activated");
}


static gboolean __lambda13_ (SlingshotFrontendIndicators* self) {
	gboolean result = FALSE;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	gint _tmp2_ = 0;
	_tmp0_ = self->priv->current_frame;
	_tmp1_ = self->priv->animation_frames;
	if (_tmp0_ >= _tmp1_) {
		slingshot_frontend_indicators_end_animation (self);
		result = FALSE;
		return result;
	}
	_tmp2_ = self->priv->current_frame;
	self->priv->current_frame = _tmp2_ + 1;
	gtk_widget_queue_draw ((GtkWidget*) self);
	result = TRUE;
	return result;
}


static gboolean ___lambda13__gsource_func (gpointer self) {
	gboolean result;
	result = __lambda13_ ((SlingshotFrontendIndicators*) self);
	return result;
}


void slingshot_frontend_indicators_change_focus (SlingshotFrontendIndicators* self) {
	gboolean _tmp0_ = FALSE;
	gint difference = 0;
	gint _tmp2_ = 0;
	gint _tmp3_ = 0;
	gint _tmp4_ = 0;
	gint _tmp5_ = 0;
	gdouble _tmp6_ = 0.0;
	gint _tmp7_ = 0;
	guint _tmp8_ = 0U;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->animation_active;
	if (_tmp0_) {
		guint _tmp1_ = 0U;
		_tmp1_ = self->priv->animation_loop_id;
		g_source_remove (_tmp1_);
		slingshot_frontend_indicators_end_animation (self);
	}
	self->priv->animation_duration = 240;
	_tmp2_ = self->priv->old_active;
	_tmp3_ = self->active;
	_tmp4_ = abs (_tmp2_ - _tmp3_);
	difference = _tmp4_;
	_tmp5_ = self->priv->animation_duration;
	_tmp6_ = pow ((gdouble) difference, 0.5);
	self->priv->animation_duration = _tmp5_ + ((gint) (_tmp6_ * 80));
	_tmp7_ = self->priv->animation_duration;
	self->priv->animation_frames = (gint) ((((gdouble) _tmp7_) / 1000) * SLINGSHOT_FRONTEND_INDICATORS_FPS);
	self->priv->current_frame = 0;
	self->priv->animation_active = TRUE;
	_tmp8_ = g_timeout_add_full (G_PRIORITY_DEFAULT, (guint) ((gint) (1000 / SLINGSHOT_FRONTEND_INDICATORS_FPS)), ___lambda13__gsource_func, g_object_ref (self), g_object_unref);
	self->priv->animation_loop_id = _tmp8_;
}


static void slingshot_frontend_indicators_end_animation (SlingshotFrontendIndicators* self) {
	g_return_if_fail (self != NULL);
	self->priv->animation_active = FALSE;
	self->priv->current_frame = 0;
}


gboolean slingshot_frontend_indicators_draw_background (SlingshotFrontendIndicators* self, GtkWidget* widget, GdkEventExpose* event) {
	gboolean result = FALSE;
	GtkAllocation size = {0};
	GtkWidget* _tmp0_ = NULL;
	GtkAllocation _tmp1_ = {0};
	cairo_t* context = NULL;
	GtkWidget* _tmp2_ = NULL;
	GdkWindow* _tmp3_ = NULL;
	cairo_t* _tmp4_ = NULL;
	gdouble d = 0.0;
	gint _tmp5_ = 0;
	gdouble t = 0.0;
	gint _tmp6_ = 0;
	gdouble progress = 0.0;
	gdouble _tmp7_ = 0.0;
	gdouble _tmp8_ = 0.0;
	gdouble _tmp9_ = 0.0;
	gdouble _tmp10_ = 0.0;
	gdouble _tmp11_ = 0.0;
	gdouble _tmp12_ = 0.0;
	GtkAllocation size_old = {0};
	GtkAllocation size_new = {0};
	GList* _tmp13_ = NULL;
	GList* _tmp14_ = NULL;
	gint _tmp15_ = 0;
	gconstpointer _tmp16_ = NULL;
	GtkAllocation _tmp17_ = {0};
	GList* _tmp18_ = NULL;
	GList* _tmp19_ = NULL;
	gint _tmp20_ = 0;
	gconstpointer _tmp21_ = NULL;
	GtkAllocation _tmp22_ = {0};
	gdouble x = 0.0;
	GtkAllocation _tmp23_ = {0};
	gint _tmp24_ = 0;
	GtkAllocation _tmp25_ = {0};
	gint _tmp26_ = 0;
	GtkAllocation _tmp27_ = {0};
	gint _tmp28_ = 0;
	gdouble width = 0.0;
	GtkAllocation _tmp29_ = {0};
	gint _tmp30_ = 0;
	GtkAllocation _tmp31_ = {0};
	gint _tmp32_ = 0;
	GtkAllocation _tmp33_ = {0};
	gint _tmp34_ = 0;
	gdouble offset = 0.0;
	gdouble radius = 0.0;
	GtkAllocation _tmp35_ = {0};
	gint _tmp36_ = 0;
	GtkAllocation _tmp37_ = {0};
	gint _tmp38_ = 0;
	GtkAllocation _tmp39_ = {0};
	gint _tmp40_ = 0;
	GtkAllocation _tmp41_ = {0};
	gint _tmp42_ = 0;
	GtkAllocation _tmp43_ = {0};
	gint _tmp44_ = 0;
	GtkAllocation _tmp45_ = {0};
	gint _tmp46_ = 0;
	GtkAllocation _tmp47_ = {0};
	gint _tmp48_ = 0;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (widget != NULL, FALSE);
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = widget;
	gtk_widget_get_allocation (_tmp0_, &_tmp1_);
	size = _tmp1_;
	_tmp2_ = widget;
	_tmp3_ = _tmp2_->window;
	_tmp4_ = gdk_cairo_create ((GdkDrawable*) _tmp3_);
	context = _tmp4_;
	_tmp5_ = self->priv->animation_frames;
	d = (gdouble) _tmp5_;
	_tmp6_ = self->priv->current_frame;
	t = (gdouble) _tmp6_;
	_tmp7_ = t;
	t = (_tmp7_ / d) - 1;
	_tmp8_ = t;
	_tmp9_ = t;
	_tmp10_ = t;
	_tmp11_ = t;
	_tmp12_ = t;
	progress = ((((_tmp8_ * _tmp9_) * _tmp10_) * _tmp11_) * _tmp12_) + 1;
	_tmp13_ = gtk_container_get_children ((GtkContainer*) self);
	_tmp14_ = _tmp13_;
	_tmp15_ = self->priv->old_active;
	_tmp16_ = g_list_nth_data (_tmp14_, (guint) _tmp15_);
	gtk_widget_get_allocation ((GtkWidget*) _tmp16_, &_tmp17_);
	size_old = _tmp17_;
	_g_list_free0 (_tmp14_);
	_tmp18_ = gtk_container_get_children ((GtkContainer*) self);
	_tmp19_ = _tmp18_;
	_tmp20_ = self->active;
	_tmp21_ = g_list_nth_data (_tmp19_, (guint) _tmp20_);
	gtk_widget_get_allocation ((GtkWidget*) _tmp21_, &_tmp22_);
	size_new = _tmp22_;
	_g_list_free0 (_tmp19_);
	_tmp23_ = size_old;
	_tmp24_ = _tmp23_.x;
	_tmp25_ = size_new;
	_tmp26_ = _tmp25_.x;
	_tmp27_ = size_old;
	_tmp28_ = _tmp27_.x;
	x = _tmp24_ + ((_tmp26_ - ((gdouble) _tmp28_)) * progress);
	_tmp29_ = size_old;
	_tmp30_ = _tmp29_.width;
	_tmp31_ = size_new;
	_tmp32_ = _tmp31_.width;
	_tmp33_ = size_old;
	_tmp34_ = _tmp33_.width;
	width = _tmp30_ + ((_tmp32_ - ((gdouble) _tmp34_)) * progress);
	cairo_set_source_rgba (context, 0.2, 0.2, 0.2, 0.7);
	offset = 0.0;
	radius = 18.0;
	_tmp35_ = size;
	_tmp36_ = _tmp35_.y;
	cairo_move_to (context, x + radius, _tmp36_ + offset);
	_tmp37_ = size;
	_tmp38_ = _tmp37_.y;
	cairo_arc (context, ((x + width) - radius) - offset, (_tmp38_ + radius) + offset, radius, G_PI * 1.5, G_PI * 2);
	_tmp39_ = size;
	_tmp40_ = _tmp39_.y;
	_tmp41_ = size;
	_tmp42_ = _tmp41_.height;
	cairo_arc (context, ((x + width) - radius) - offset, ((_tmp40_ + _tmp42_) - radius) - offset, radius, (gdouble) 0, G_PI * 0.5);
	_tmp43_ = size;
	_tmp44_ = _tmp43_.y;
	_tmp45_ = size;
	_tmp46_ = _tmp45_.height;
	cairo_arc (context, (x + radius) + offset, ((_tmp44_ + _tmp46_) - radius) - offset, radius, G_PI * 0.5, G_PI);
	_tmp47_ = size;
	_tmp48_ = _tmp47_.y;
	cairo_arc (context, (x + radius) + offset, (_tmp48_ + radius) + offset, radius, G_PI, G_PI * 1.5);
	cairo_fill (context);
	result = FALSE;
	_cairo_destroy0 (context);
	return result;
}


static void slingshot_frontend_indicators_class_init (SlingshotFrontendIndicatorsClass * klass) {
	slingshot_frontend_indicators_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (SlingshotFrontendIndicatorsPrivate));
	G_OBJECT_CLASS (klass)->finalize = slingshot_frontend_indicators_finalize;
	g_signal_new ("child_activated", SLINGSHOT_FRONTEND_TYPE_INDICATORS, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
}


static void slingshot_frontend_indicators_instance_init (SlingshotFrontendIndicators * self) {
	self->priv = SLINGSHOT_FRONTEND_INDICATORS_GET_PRIVATE (self);
	self->priv->current_frame = 1;
	self->priv->animation_loop_id = (guint) 0;
	self->priv->animation_active = FALSE;
	self->active = -1;
	self->priv->old_active = -1;
}


static void slingshot_frontend_indicators_finalize (GObject* obj) {
	SlingshotFrontendIndicators * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, SLINGSHOT_FRONTEND_TYPE_INDICATORS, SlingshotFrontendIndicators);
	__g_list_free__g_object_unref0_0 (self->children);
	G_OBJECT_CLASS (slingshot_frontend_indicators_parent_class)->finalize (obj);
}


GType slingshot_frontend_indicators_get_type (void) {
	static volatile gsize slingshot_frontend_indicators_type_id__volatile = 0;
	if (g_once_init_enter (&slingshot_frontend_indicators_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (SlingshotFrontendIndicatorsClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) slingshot_frontend_indicators_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (SlingshotFrontendIndicators), 0, (GInstanceInitFunc) slingshot_frontend_indicators_instance_init, NULL };
		GType slingshot_frontend_indicators_type_id;
		slingshot_frontend_indicators_type_id = g_type_register_static (GTK_TYPE_HBOX, "SlingshotFrontendIndicators", &g_define_type_info, 0);
		g_once_init_leave (&slingshot_frontend_indicators_type_id__volatile, slingshot_frontend_indicators_type_id);
	}
	return slingshot_frontend_indicators_type_id__volatile;
}



